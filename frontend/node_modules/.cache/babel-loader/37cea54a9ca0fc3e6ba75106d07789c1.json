{"ast":null,"code":"import _toConsumableArray from\"/Users/alexandrkatsuro/Downloads/mesto-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/alexandrkatsuro/Downloads/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import Header from\"./Header.js\";import Main from\"./Main.js\";import Footer from\"./Footer.js\";import PopupWithForm from\"./PopupWithForm.js\";import ImagePopup from\"./ImagePopup.js\";import api from\"../utils/Api.js\";import{CurrentUserContext}from\"../contexts/CurrentUserContext.js\";import EditProfilePopup from\"./EditProfilePopup.js\";import EditAvatarPopup from\"./EditAvatarPopup.js\";import AddPlacePopup from\"./AddPlacePopup.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isEditProfilePopupOpen=_useState2[0],setEditProfileClick=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAddPlacePopupOpen=_useState4[0],setAddPlacePopupOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditAvatarPopupOpen=_useState6[0],setEditAvatarPopupOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isEditAcceptPopupOpen=_useState8[0],setEditAcceptPopupOpen=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),currentUser=_useState10[0],setCurrentUser=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),cards=_useState12[0],setCards=_useState12[1];var _useState13=useState({isOpen:false,element:{}}),_useState14=_slicedToArray(_useState13,2),selectedCard=_useState14[0],setSelectedCard=_useState14[1];useEffect(function(){api.getProfileData().then(function(data){setCurrentUser(data);}).catch(function(err){return console.log(err);});},[]);useEffect(function(){api.getInitialCards().then(function(data){setCards(data);}).catch(function(err){return console.log(err);});},[]);function closeAllPopups(){setEditProfileClick(false);setAddPlacePopupOpen(false);setEditAvatarPopupOpen(false);setEditAcceptPopupOpen(false);setSelectedCard({isOpen:false,element:{}});}function handleCardClick(card){setSelectedCard({isOpen:true,element:card});}function handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(i){return i._id===currentUser._id;});// Отправляем запрос в API и получаем обновлённые данные карточки\napi.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){console.log(err);});}function handleCardDelete(card){api.deleteCard(card._id).then(function(){var newCards=cards.filter(function(c){return c._id===card._id?false:true;});setCards(newCards);closeAllPopups();}).catch(function(err){console.log(err);});}function handleUpdateUser(newUserData){api.setUserInfo(newUserData).then(function(data){setCurrentUser(data);closeAllPopups();}).catch(function(err){console.log(err);});}function handleUpdateAvatar(newAvatarLink){api.setUserAvatar(newAvatarLink).then(function(data){setCurrentUser({currentUser:currentUser,avatar:data.avatar});closeAllPopups();}).catch(function(err){console.log(err);});}function handleAddPlaceSubmit(cardData){api.postNewCard(cardData).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){console.log(err);});}console.log(selectedCard);return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{currentUser:currentUser,cards:cards,onEditProfile:function onEditProfile(){return setEditProfileClick(true);},onEditAvatar:function onEditAvatar(){return setEditAvatarPopupOpen(true);},onAddPlace:function onAddPlace(){return setAddPlacePopupOpen(true);},onCardClick:handleCardClick,onCardLike:handleCardLike,onCardDelete:handleCardDelete}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(PopupWithForm,{name:\"accept\",title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",onClose:closeAllPopups,isOpen:isEditAcceptPopupOpen,buttonTitle:\"\\u0414\\u0430\"})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Header","Main","Footer","PopupWithForm","ImagePopup","api","CurrentUserContext","EditProfilePopup","EditAvatarPopup","AddPlacePopup","App","isEditProfilePopupOpen","setEditProfileClick","isAddPlacePopupOpen","setAddPlacePopupOpen","isEditAvatarPopupOpen","setEditAvatarPopupOpen","isEditAcceptPopupOpen","setEditAcceptPopupOpen","currentUser","setCurrentUser","cards","setCards","isOpen","element","selectedCard","setSelectedCard","getProfileData","then","data","catch","err","console","log","getInitialCards","closeAllPopups","handleCardClick","card","handleCardLike","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","state","map","c","handleCardDelete","deleteCard","newCards","filter","handleUpdateUser","newUserData","setUserInfo","handleUpdateAvatar","newAvatarLink","setUserAvatar","avatar","handleAddPlaceSubmit","cardData","postNewCard"],"sources":["/Users/alexandrkatsuro/Downloads/mesto-react/src/components/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Header from \"./Header.js\";\nimport Main from \"./Main.js\";\nimport Footer from \"./Footer.js\";\nimport PopupWithForm from \"./PopupWithForm.js\";\nimport ImagePopup from \"./ImagePopup.js\";\nimport api from \"../utils/Api.js\";\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext.js\";\nimport EditProfilePopup from \"./EditProfilePopup.js\";\nimport EditAvatarPopup from \"./EditAvatarPopup.js\";\nimport AddPlacePopup from \"./AddPlacePopup.js\";\n\nfunction App() {\n  const [isEditProfilePopupOpen, setEditProfileClick] = useState(false);\n  const [isAddPlacePopupOpen, setAddPlacePopupOpen] = useState(false);\n  const [isEditAvatarPopupOpen, setEditAvatarPopupOpen] = useState(false);\n  const [isEditAcceptPopupOpen, setEditAcceptPopupOpen] = useState(false);\n\n  const [currentUser, setCurrentUser] = useState({});\n  const [cards, setCards] = useState([]);\n  const [selectedCard, setSelectedCard] = useState({\n    isOpen: false,\n    element: {},\n  });\n\n  useEffect(() => {\n    api\n      .getProfileData()\n      .then((data) => {\n        setCurrentUser(data);\n      })\n      .catch((err) => console.log(err));\n  }, []);\n\n  useEffect(() => {\n    api\n      .getInitialCards()\n      .then((data) => {\n        setCards(data);\n      })\n      .catch((err) => console.log(err));\n  }, []);\n\n  function closeAllPopups() {\n    setEditProfileClick(false);\n    setAddPlacePopupOpen(false);\n    setEditAvatarPopupOpen(false);\n    setEditAcceptPopupOpen(false);\n    setSelectedCard({ isOpen: false, element: {} });\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard({ isOpen: true, element: card });\n  }\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some((i) => i._id === currentUser._id);\n    // Отправляем запрос в API и получаем обновлённые данные карточки\n    api\n      .changeLikeCardStatus(card._id, !isLiked)\n      .then((newCard) => {\n        setCards((state) =>\n          state.map((c) => (c._id === card._id ? newCard : c))\n        );\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function handleCardDelete(card) {\n    api\n      .deleteCard(card._id)\n      .then(() => {\n        const newCards = cards.filter((c) =>\n          c._id === card._id ? false : true\n        );\n        setCards(newCards);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function handleUpdateUser(newUserData) {\n    api\n      .setUserInfo(newUserData)\n      .then((data) => {\n        setCurrentUser(data);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function handleUpdateAvatar(newAvatarLink) {\n    api\n      .setUserAvatar(newAvatarLink)\n      .then((data) => {\n        setCurrentUser({ currentUser, avatar: data.avatar });\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function handleAddPlaceSubmit(cardData) {\n    api\n      .postNewCard(cardData)\n      .then((newCard) => {\n        setCards([newCard, ...cards]);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  console.log(selectedCard);\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"page\">\n        <Header />\n        <Main\n          currentUser={currentUser}\n          cards={cards}\n          onEditProfile={() => setEditProfileClick(true)}\n          onEditAvatar={() => setEditAvatarPopupOpen(true)}\n          onAddPlace={() => setAddPlacePopupOpen(true)}\n          onCardClick={handleCardClick}\n          onCardLike={handleCardLike}\n          onCardDelete={handleCardDelete}\n        />\n        <Footer />\n\n        <ImagePopup card={selectedCard} onClose={closeAllPopups} />\n\n        <EditProfilePopup\n          isOpen={isEditProfilePopupOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n        />\n\n        <EditAvatarPopup\n          isOpen={isEditAvatarPopupOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n        />\n\n        <AddPlacePopup\n          isOpen={isAddPlacePopupOpen}\n          onClose={closeAllPopups}\n          onAddPlace={handleAddPlaceSubmit}\n        />\n\n        <PopupWithForm\n          name=\"accept\"\n          title=\"Вы уверены?\"\n          onClose={closeAllPopups}\n          isOpen={isEditAcceptPopupOpen}\n          buttonTitle=\"Да\"\n        ></PopupWithForm>\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}